---
title: "Guia de Testes"
description: "Aprenda como testar sua integração com a API FireBanking"
---

## Ambientes de Teste

O FireBanking oferece ambientes separados para teste e produção, garantindo desenvolvimento e integração seguros.

<CardGroup cols={2}>
  <Card title="Ambiente Sandbox" icon="flask">
    **Base URL**: `https://api-gateway.firebanking.dev`

    Testes seguros com dados e números de cartão fictícios

  </Card>
  <Card title="Ambiente de Produção" icon="globe">
    **Base URL**: `https://api-gateway.firebanking.com.br`

    Ambiente real para transações efetivas

  </Card>
</CardGroup>

## Credenciais de Teste

### Tokens da API Sandbox

Tokens de sandbox são prefixados com `fbk_test_` e funcionam apenas no ambiente de teste:

```bash
x-api-key: fbk_test_1234567890abcdef...
```

### Credenciais de Webhook Sandbox

Use credenciais específicas de webhook para testes:

- **Usuário**: `test_webhook_user`
- **Senha**: `test_webhook_password_123`

<Warning>
  Nunca use credenciais de produção no sandbox ou credenciais de sandbox em
  produção.
</Warning>

## Cartões para Testes

Como testar cobranças de cartão em sandbox

Os cartões a serem utilizados no teste, devem ter números válidos e podem ser gerados a partir de qualquer site gerador de cartões, devendo o comportamento seguir as seguintes regra para diferentes validação de diferentes cenários:

| Cartão          | Autorizado?       | Status             | Exemplo             |
| --------------- | ----------------- | ------------------ | ------------------- |
| Final 0, 1 ou 4 | SIM               | Aprovado           | 5186 8825 4989 5601 |
| Final 2         | NÃO               | Não autorizado     | 5465 4157 3697 6082 |
| Final 3         | NÃO               | Cartão expirado    | 5112 9708 0010 5403 |
| Final 5         | NÃO               | Cartão bloqueado   | 5528 4303 3551 3025 |
| Final 6         | NÃO               | Timeout            | 5186 8825 4989 5601 |
| Final 7         | NÃO               | Cartão cancelado   | 5325 8272 3667 3227 |
| Final 8         | Aleatório SIM/NÃO | Aprovado / Timeout | 5397 5499 7073 5078 |

Em sandbox, para testar os cenários acima, o CVV sempre deve ser um número de 3 dígitos terminado em zero (Ex: 220). Um número de CVV diferente de zero, irá resultar em falha na geração da transação.

### Exemplo de Cartão Completo para Teste

```json Cartão de Teste
{
  "holderName": "JOSE DAS NEVES TEST",
  "number": "5383638854408981",
  "cvv": 220,
  "expiration": "12/2024"
}
```

## Dados de Comprador de Teste

Use dados de comprador realistas mas fictícios para testes:

### Números de CPF Válidos para Teste

```json Comprador Teste
{
  "name": "João da Silva Teste",
  "document": "11144477735", // CPF válido para testes
  "email": "joao.teste@example.com",
  "phone": "11999999999",
  "countryCode": "+55",
  "address": {
    "country": "BR",
    "state": "SP",
    "city": "São Paulo",
    "district": "Centro",
    "street": "Rua das Flores",
    "zipCode": "01000000",
    "number": "123"
  }
}
```

### Números de CNPJ Válidos para Teste

```json Comprador Empresa Teste
{
  "name": "Empresa Teste LTDA",
  "document": "11222333000181", // CNPJ válido para testes
  "email": "contato@empresateste.com",
  "phone": "1133334444",
  "countryCode": "+55"
}
```

## Cenários de Teste

### Fluxo Básico de Pagamento

```bash Pagamento Teste
curl -X POST "https://api-gateway.firebanking.dev/v1/payment" \
  -H "x-api-key: fbk_test_seu_token" \
  -H "Content-Type: application/json" \
  -d '{
    "purchaseValue": 10000,
    "installments": 1,
    "externalId": "test-payment-001",
    "purchaseTitle": "Compra Teste",
    "payment": {
      "chargeType": "FEE_TO_CUSTOMER",
      "capture": true,
      "card": {
        "name": "João da Silva Teste",
        "number": "5186882549895601",
        "expiration": "12/2025",
        "securityCode": "220"
      }
    },
    "buyer": {
      "name": "João da Silva Teste",
      "document": "11144477735",
      "email": "joao.teste@example.com",
      "phone": "11999999999",
      "countryCode": "+55",
      "address": {
        "country": "BR",
        "state": "SP",
        "city": "São Paulo",
        "district": "Centro",
        "street": "Rua das Flores",
        "zipCode": "01000000",
        "number": "123"
      }
    }
  }'
```

### Testando Tokenização de Cartão

```bash Criação de Token Teste
curl -X POST "https://api-gateway.firebanking.dev/v1/payment/token" \
  -H "x-api-key: fbk_test_seu_token" \
  -H "Content-Type: application/json" \
  -d '{
    "card": {
      "name": "João da Silva Teste",
      "number": "5186882549895601",
      "expiration": "12/25",
      "securityCode": "123"
    },
    "buyer": {
      "name": "João da Silva Teste",
      "document": "11144477735",
      "email": "joao.teste@example.com",
      "phone": "11999999999",
      "countryCode": "+55",
      "address": {
        "country": "BR",
        "state": "SP",
        "city": "São Paulo",
        "district": "Centro",
        "street": "Rua das Flores",
        "zipCode": "01000000",
        "number": "123"
      }
    },
    "checkZeroDollar": true
  }'
```

### Testando Criação de Assinatura

```bash Assinatura Teste
curl -X POST "https://api-gateway.firebanking.dev/v1/subscription" \
  -H "x-api-key: fbk_test_seu_token" \
  -H "Content-Type: application/json" \
  -d '{
    "uuidPlan": "test-plan-monthly-2999",
    "basicValue": {
      "type": "MONTHLY",
      "valuePerMonth": 2999
    },
    "payment": {
      "method": "CREDIT_CARD",
      "card": {
        "name": "João da Silva Teste",
        "number": "5186882549895601",
        "expiration": "12/2025",
        "securityCode": "220"
      }
    },
    "buyer": {
      "name": "João da Silva Teste",
      "document": "11144477735",
      "email": "joao.teste@example.com",
      "phone": "11999999999",
      "countryCode": "+55"
    },
    "startDate": "2024-02-01",
    "description": "Assinatura Mensal Teste"
  }'
```

## Teste de Erros

### Testar Requisições Inválidas

```bash Valor Inválido
curl -X POST "https://api-gateway.firebanking.dev/v1/payment" \
  -H "x-api-key: fbk_test_seu_token" \
  -H "Content-Type: application/json" \
  -d '{
    "purchaseValue": -100,
    "installments": 0
  }'
```

### Testar Erros de Autenticação

```bash Token Inválido
curl -X POST "https://api-gateway.firebanking.dev/v1/payment" \
  -H "x-api-key: token_invalido" \
  -H "Content-Type: application/json" \
  -d '{...}'
```

## Teste de Webhooks

### Configurando Webhooks de Teste

Use ferramentas como ngrok para testar webhooks localmente:

```bash Configuração do Ngrok
# Instalar ngrok
npm install -g ngrok

# Expor porta local
ngrok http 3000

# Use a URL HTTPS na configuração do webhook
# https://abc123.ngrok.io/webhooks/firebanking
```

### Manipulador de Webhook de Teste

```javascript Manipulador Webhook Express.js
const express = require("express");
const app = express();

app.use(express.json());

app.post("/webhooks/firebanking", (req, res) => {
  console.log("Webhook recebido:", req.body);

  const { eventType, data } = req.body;

  // Manipula diferentes tipos de evento
  switch (eventType) {
    case "PAYMENT_COMPLETED":
      console.log("Pagamento concluído:", data.paymentId);
      break;
    case "PAYMENT_FAILED":
      console.log("Pagamento falhou:", data.paymentId);
      break;
    default:
      console.log("Tipo de evento desconhecido:", eventType);
  }

  // Sempre retorna 200 para confirmar recebimento
  res.status(200).json({ received: true });
});

app.listen(3000, () => {
  console.log("Servidor webhook rodando na porta 3000");
});
```

### Testando Entrega de Webhooks

Você pode disparar webhooks de teste manualmente usando ferramentas online:

<CardGroup cols={2}>
  <Card title="Webhook.site" icon="globe">
    **URL**: webhook.site Capture e inspecione payloads de webhook
  </Card>
  <Card title="RequestBin" icon="inbox">
    **URL**: requestbin.com Criação de endpoints temporários de webhook
  </Card>
</CardGroup>

## Checklist de Testes

### Testes Pré-Integração

<CardGroup cols={2}>
  <Card title="Autenticação" icon="key">
    - [ ] Testar validação de token - [ ] Testar respostas de erro - [ ]
    Verificar separação de ambientes
  </Card>
  <Card title="Operações Básicas" icon="check">
    - [ ] Endpoint de verificação de saúde - [ ] Recuperação de saldo da conta -
    [ ] Tratamento de erros
  </Card>
</CardGroup>

### Teste de Pagamentos

- [ ] **Pagamento bem-sucedido** com cartão de teste aprovado
- [ ] **Pagamento falhado** com cartão de teste recusado
- [ ] Tratamento de **número de cartão inválido**
- [ ] Tratamento de erro de **cartão vencido**
- [ ] Validação de **valor inválido**
- [ ] Validação de **campos obrigatórios ausentes**
- [ ] Fluxo de **pré-autorização** e captura
- [ ] Processamento de **estorno**
- [ ] Teste de **parcelamento múltiplo**

### Teste de Token de Cartão

- [ ] **Criação de token** com cartão válido
- [ ] **Criação de token** com cartão inválido
- [ ] **Recuperação de token** por UUID do comprador
- [ ] **Pagamento com token** (CVV válido)
- [ ] **Pagamento com token** (CVV inválido)
- [ ] Teste de **verificação zero dollar**

### Teste de Assinatura

- [ ] Criação de **assinatura mensal**
- [ ] Criação de **assinatura trimestral**
- [ ] Criação de **assinatura anual**
- [ ] **Atualização de assinatura** (valor e frequência)
- [ ] **Cancelamento de assinatura**
- [ ] Tratamento de **pagamento falhado**
- [ ] **Notificações webhook** para eventos de assinatura

### Teste de Tratamento de Erros

- [ ] Tratamento de **timeouts de rede**
- [ ] Respostas de **limite de taxa**
- [ ] Tratamento de **erros de servidor** (500)
- [ ] Respostas de **JSON inválido**
- [ ] **Falhas de autenticação**
- [ ] **Requisições malformadas**

### Teste de Webhook

- [ ] Configuração e acessibilidade do **endpoint webhook**
- [ ] **Autenticação** (se necessário)
- [ ] **Processamento de eventos** para todos os tipos de evento
- [ ] **Idempotência** (tratamento de eventos duplicados)
- [ ] Teste do **mecanismo de retry**
- [ ] Tratamento de **resposta de erro**

## Ferramentas de Teste

### Ferramentas de Teste de API

<CardGroup cols={2}>
  <Card title="Postman" icon="globe">
    **Uso**: Teste interativo de API e gerenciamento de coleções
  </Card>
  <Card title="Insomnia" icon="moon">
    **Uso**: Cliente REST com gerenciamento de ambiente
  </Card>
  <Card title="curl" icon="terminal">
    **Uso**: Teste via linha de comando e automação
  </Card>
  <Card title="HTTPie" icon="terminal">
    **Uso**: Cliente HTTP de linha de comando amigável
  </Card>
</CardGroup>

### Testes Automatizados

```javascript Exemplo de Teste Jest
const request = require("supertest");

describe("API FireBanking", () => {
  const apiToken = process.env.FIREBANKING_TEST_TOKEN;
  const baseURL = "https://api-gateway.firebanking.dev/v1";

  test("deve criar pagamento com sucesso", async () => {
    const paymentData = {
      purchaseValue: 10000,
      installments: 1,
      externalId: `test-${Date.now()}`,
      payment: {
        chargeType: "FEE_TO_CUSTOMER",
        capture: true,
        card: {
          name: "João da Silva Teste",
          number: "5186882549895601",
          expiration: "12/25",
          securityCode: "123",
        },
      },
      buyer: {
        name: "João da Silva Teste",
        document: "11144477735",
        email: "joao.teste@example.com",
        phone: "11999999999",
        countryCode: "+55",
        address: {
          country: "BR",
          state: "SP",
          city: "São Paulo",
          district: "Centro",
          street: "Rua das Flores",
          zipCode: "01000000",
          number: "123",
        },
      },
    };

    const response = await request(baseURL)
      .post("/payment")
      .set("x-api-key", ` ${apiToken}`)
      .send(paymentData)
      .expect(200);

    expect(response.body).toHaveProperty("id");
    expect(response.body.status).toMatch(/processing|completed/);
    expect(response.body.amount).toBe(10000);
  });

  test("deve tratar cartão recusado", async () => {
    const paymentData = {
      purchaseValue: 10000,
      installments: 1,
      payment: {
        chargeType: "FEE_TO_CUSTOMER",
        card: {
          name: "João da Silva Teste",
          number: "4000000000000002", // Sempre recusado
          expiration: "12/25",
          securityCode: "123",
        },
      },
      // ... resto dos dados de pagamento
    };

    const response = await request(baseURL)
      .post("/payment")
      .set("x-api-key", ` ${apiToken}`)
      .send(paymentData)
      .expect(400);

    expect(response.body.error).toBeDefined();
  });
});
```

## Indo para Produção

### Checklist Pré-Produção

Antes de mudar para produção:

- [ ] **Testes abrangentes** concluídos no sandbox
- [ ] **Tratamento de erros** implementado e testado
- [ ] **Endpoints de webhook** protegidos e testados
- [ ] **Credenciais de produção** obtidas e protegidas
- [ ] Tratamento de **limite de taxa** implementado
- [ ] **Monitoramento** e logging configurados
- [ ] **Revisão de segurança** concluída

### Migração para Produção

1. **Atualizar URL base** para `https://api-gateway.firebanking.com.br`
2. **Substituir credenciais de teste** por credenciais de produção
3. **Atualizar URLs de webhook** para endpoints de produção
4. **Verificar processamento de cartão real** com valores pequenos
5. **Monitorar transações** de perto inicialmente
6. **Configurar alertas** para erros e falhas

<Info>
  Comece com valores pequenos de transação em produção para verificar se tudo
  funciona corretamente antes de processar pagamentos maiores.
</Info>

Pronto para começar a testar? Comece com a [configuração de autenticação](/authentication) e depois tente [criar seu primeiro pagamento de teste](/api-reference/payment/create).
