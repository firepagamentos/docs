---
title: 'Autenticação'
description: 'Aprenda como se autenticar com a API FireBanking'
---

## Visão Geral

A API FireBanking usa um método de autenticação **simples e consistente** para todas as operações. Nossa arquitetura unificada garante que você use as mesmas credenciais para todos os métodos de pagamento.

<CardGroup cols={1}>
  <Card title="x-api-key" icon="key">
    **Método Único de Autenticação**
    Usado em todos os endpoints: Cartão de Crédito, PIX, Boleto e APIs gerais
  </Card>
</CardGroup>

### Características da Autenticação

<AccordionGroup>
  <Accordion title="Formato Padronizado">
    - **Header obrigatório**: `x-api-key` em todas as requisições
    - **Formato JSON**: Todas as respostas seguem estrutura consistente
    - **Códigos HTTP semânticos**: Status codes padronizados
    - **Identificadores únicos**: Recursos com IDs consistentes
  </Accordion>

  <Accordion title="Segurança Integrada">
    - **Webhooks assinados**: Verificação automática de integridade
    - **Erro 403 Forbidden**: Para credenciais inválidas ou expiradas
    - **Rate limiting**: Proteção contra abuso de API
    - **Logs de auditoria**: Rastreamento completo de operações
  </Accordion>
</AccordionGroup>

## Autenticação x-api-key

Todos os endpoints da API usam autenticação através do cabeçalho `x-api-key` com sua **Chave de API**.

### Uso

Inclua sua chave de API no cabeçalho `x-api-key`:

```bash
x-api-key: SUA_CHAVE_DE_API
```

### Exemplo de Requisição

```bash Exemplo cURL
curl -X GET "https://api-gateway.firebanking.com.br/v1/account/balance" \
  -H "x-api-key: fbk_live_1234567890abcdef..." \
  -H "Content-Type: application/json"
```

### Endpoints Aplicáveis

A autenticação x-api-key é usada para:
- **Operações de pagamento** (criar, listar, obter, capturar, estornar)
- **Pagamentos PIX** (criar, listar, consultar)
- **Boletos** (criar, consultar, listar)
- **Tokenização de cartão** (criar tokens, recuperar tokens)
- **Gerenciamento de comprador** (criar, listar compradores)
- **Gerenciamento de assinatura** (criar, atualizar, cancelar)
- **Operações de conta** (saldo, configurações)

## Webhooks

Endpoints de webhook não requerem autenticação via cabeçalho. A segurança é fornecida através de:

- **URLs únicas**: Específicas para cada conta
- **Assinatura digital**: Verificação de integridade do payload
- **Retry automático**: Tentativas automáticas em caso de falha
- **Timeout configurável**: Controle de tempo de resposta

### Verificação de Assinatura

```javascript Exemplo de Verificação
const crypto = require('crypto');

function verifyWebhookSignature(payload, signature, secret) {
  const expectedSignature = crypto
    .createHmac('sha256', secret)
    .update(payload)
    .digest('hex');

  return crypto.timingSafeEqual(
    Buffer.from(signature, 'hex'),
    Buffer.from(expectedSignature, 'hex')
  );
}
```

## Tratamento de Erros

### Códigos de Resposta

| Código | Descrição | Ação Recomendada |
|--------|-----------|------------------|
| **200 OK** | Requisição processada com sucesso | Continue com o fluxo |
| **400 Bad Request** | Erro na estrutura da requisição | Verifique parâmetros enviados |
| **401 Unauthorized** | Chave de API ausente | Adicione header `x-api-key` |
| **403 Forbidden** | Chave de API inválida ou expirada | Verifique suas credenciais |
| **429 Too Many Requests** | Limite de requisições excedido | Implemente retry com backoff |
| **500 Internal Server Error** | Erro interno do servidor | Tente novamente ou contate suporte |

### Estrutura de Erro Padronizada

```json Exemplo de Resposta de Erro
{
  "error": {
    "code": "INVALID_API_KEY",
    "message": "Chave de API inválida ou expirada",
    "details": "Verifique se a chave está correta e ativa",
    "request_id": "req_1234567890",
    "timestamp": "2024-01-15T10:30:00Z"
  }
}
```

### Segurança de Webhook

- **URL única**: Cada conta possui uma URL específica de webhook
- **Sem cabeçalhos de auth**: Webhooks não requerem x-api-key
- **Validação via payload**: Verifique a estrutura e origem dos dados

## Obtendo sua Chave de API

### Chave de API FireBanking

1. **Faça login** no seu painel FireBanking
2. **Navegue para** Configurações de API ou seção de Desenvolvedor
3. **Gere** ou copie sua Chave de API
4. **Armazene com segurança** - trate como uma senha

### Formatos de Chave

<CardGroup cols={2}>
  <Card title="Chaves de Sandbox" icon="flask">
    **Formato**: `fbk_test_...`  
    Para testes e desenvolvimento
  </Card>
  <Card title="Chaves de Produção" icon="globe">
    **Formato**: `fbk_live_...`  
    Apenas para transações ao vivo
  </Card>
</CardGroup>

## Melhores Práticas de Segurança

### Segurança da Chave

<CardGroup cols={2}>
  <Card title="Variáveis de Ambiente" icon="server">
    Armazene chaves em variáveis de ambiente, não no código fonte
  </Card>
  <Card title="Apenas HTTPS" icon="lock">
    Sempre use HTTPS para requisições de API
  </Card>
  <Card title="Rotação de Chave" icon="rotate">
    Rotacione chaves periodicamente por segurança
  </Card>
  <Card title="Controle de Acesso" icon="shield">
    Limite acesso da chave a pessoal autorizado
  </Card>
</CardGroup>

### Segurança de Implementação

```javascript Uso Seguro de Chave
// ✅ Bom - Variável de ambiente
const apiKey = process.env.FIREBANKING_API_KEY;

// ❌ Ruim - Codificado no fonte
const apiKey = 'fbk_live_1234567890abcdef';

// ✅ Bom - Cabeçalhos seguros
const headers = {
  'x-api-key': apiKey,
  'Content-Type': 'application/json',
  'User-Agent': 'SeuApp/1.0'
};
```

### Tratamento de Erros

Sempre trate erros de autenticação de forma graciosa:

```javascript Tratamento de Erros
try {
  const response = await fetch('https://api-gateway.firebanking.com.br/v1/payment', {
    method: 'POST',
    headers: {
      'x-api-key': apiKey,
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(paymentData)
  });

  if (response.status === 401) {
    // Tratar não autorizado - chave pode ser inválida
    throw new Error('Chave de API inválida');
  }
  
  if (response.status === 403) {
    // Tratar proibido - chave não tem permissões
    throw new Error('Permissões insuficientes');
  }

  const result = await response.json();
  return result;
  
} catch (error) {
  console.error('Erro de autenticação:', error);
  throw error;
}
```

## Erros de Autenticação

### Respostas de Erro Comuns

#### Chave Inválida
```json
{
  "error": 401,
  "message": "Chave de API inválida ou expirada",
  "code": "INVALID_API_KEY"
}
```

#### Permissões Insuficientes
```json
{
  "error": 403,
  "message": "Chave não tem as permissões necessárias",
  "code": "INSUFFICIENT_PERMISSIONS"
}
```

#### Autenticação Ausente
```json
{
  "error": 401,
  "message": "Chave de API necessária",
  "code": "MISSING_API_KEY"
}
```

### Solução de Problemas

<CardGroup cols={2}>
  <Card title="Verificar Formato da Chave" icon="check">
    Certifique-se de que a chave comece com `fbk_test_` ou `fbk_live_`
  </Card>
  <Card title="Verificar Ambiente" icon="server">
    Use chaves de teste com sandbox, chaves live com produção
  </Card>
  <Card title="Testar Permissões" icon="key">
    Tente um endpoint simples como `/health` primeiro
  </Card>
  <Card title="Verificar Expiração" icon="clock">
    Algumas chaves podem ter datas de expiração
  </Card>
</CardGroup>

## Limitação de Taxa

Todas as chaves têm os mesmos limites de taxa:

| Tipo de Operação | Limite de Taxa | Uso |
|------------------|-------------|-----|
| Operações de API | 60 req/min | Pagamentos, consultas, etc. |
| Webhooks | Sem limite | Recebimento de notificações |

<Info>
  Limites de taxa são aplicados por chave de API, não por endereço IP.
</Info>

## Testando Autenticação

### Verificação de Saúde (Sem Autenticação)

```bash
curl -X GET "https://api-gateway.firebanking.com.br/v1/health"
```

### Teste de Chave de API

```bash
curl -X GET "https://api-gateway.firebanking.com.br/v1/account/balance" \
  -H "x-api-key: SUA_CHAVE"
```

Pronto para fazer requisições autenticadas? Comece [criando seu primeiro pagamento](/api-reference/credit-card/payment/create) ou explore a [referência da API](/api-reference/credit-card/introduction).