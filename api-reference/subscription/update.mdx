---
title: 'Atualizar Assinatura'
openapi: 'PATCH /subscription/{subscriptionId}'
---

Atualizar a frequência de cobrança ou valor de uma assinatura ativa. Mudanças normalmente têm efeito no próximo ciclo de cobrança.

## Parâmetros de Caminho

<ParamField path="subscriptionId" type="string" required>
  O UUID da assinatura a ser atualizada
</ParamField>

## O Que Você Pode Atualizar

Atualmente, você pode modificar o **valor básico** da assinatura incluindo:
- Frequência de cobrança (MONTHLY ↔ QUARTERLY ↔ ANNUALLY)
- Valor mensal (aumentar ou diminuir)

## Exemplos de Requisições

### Mudar para Cobrança Mensal
```json Requisição Mensal
{
  "basicValue": {
    "type": "MONTHLY",
    "valuePerMonth": 4999
  }
}
```

### Mudar para Cobrança Trimestral
```json Requisição Trimestral
{
  "basicValue": {
    "type": "QUARTERLY",
    "valuePerMonth": 12999
  }
}
```

### Mudar para Cobrança Anual
```json Requisição Anual
{
  "basicValue": {
    "type": "ANNUALLY",
    "valuePerMonth": 29999
  }
}
```

## Exemplo de Resposta

```json Resposta
{
  "uuid": "subscription-uuid-12345",
  "status": "active",
  "planUuid": "plan-uuid-12345",
  "basicValue": {
    "type": "MONTHLY",
    "valuePerMonth": 4999
  },
  "buyerUuid": "buyer-uuid-67890",
  "startDate": "2024-02-01",
  "nextBillingDate": "2024-03-01",
  "totalMonthlyValue": 4999,
  "updatedAt": "2024-01-25T10:15:00Z",
  "changeEffectiveDate": "2024-03-01"
}
```

## Comportamento da Atualização

### Mudanças Imediatas
- **Atualizações de status**: Refletidas imediatamente na resposta
- **Metadados**: Atualizados instantaneamente

### Próximo Ciclo de Cobrança
- **Frequência de cobrança**: Tem efeito na próxima data de cobrança
- **Mudanças de valor**: Aplicadas à próxima cobrança
- **Rateio**: Não calculado automaticamente

## Mudanças de Frequência de Cobrança

<CardGroup cols={3}>
  <Card title="Mensal → Trimestral" icon="arrow-right">
    Próxima cobrança em 3 meses da próxima data de cobrança
  </Card>
  <Card title="Trimestral → Mensal" icon="arrow-right">
    Próxima cobrança em 1 mês da próxima data de cobrança
  </Card>
  <Card title="Qualquer → Anual" icon="arrow-right">
    Próxima cobrança em 12 meses da próxima data de cobrança
  </Card>
</CardGroup>

## Mudanças de Valor

### Aumentos de Preço
- Têm efeito no próximo ciclo de cobrança
- Sem cobrança imediata pela diferença
- Cliente deve ser notificado antecipadamente

### Reduções de Preço
- Têm efeito no próximo ciclo de cobrança
- Sem reembolso automático para período atual
- Considere ratear manualmente se necessário

## Cenários de Rateio

A API não lida automaticamente com rateio. Para mudanças complexas de cobrança, considere:

1. **Cancelar assinatura atual**
2. **Criar nova assinatura** com novos termos
3. **Crédito/cobrança manual** para valor de rateio

## Campos da Resposta

<ResponseField name="changeEffectiveDate" type="string">
  Data quando as mudanças terão efeito (normalmente próxima data de cobrança)
</ResponseField>

<ResponseField name="totalMonthlyValue" type="integer">
  Novo valor mensal total incluindo todas as cobranças
</ResponseField>

## Restrições de Atualização

### Não Pode Atualizar
- **UUID do plano**: Plano da assinatura não pode ser alterado
- **Valores adicionais**: Taxas de configuração não podem ser modificadas
- **Método de pagamento**: Use endpoints separados de gerenciamento de cartão
- **Data de início**: Data de início histórica não pode ser modificada

### Requisitos de Status
- Assinatura deve estar com status `active` ou `past_due`
- Assinaturas `cancelled` ou `expired` não podem ser atualizadas

<Warning>
  Sempre valide que o cliente concorda com mudanças de cobrança antes de atualizar assinaturas.
</Warning>

## Melhores Práticas

1. **Consentimento do cliente** - Obter aprovação explícita para mudanças de cobrança
2. **Aviso antecipado** - Notificar clientes antes das mudanças terem efeito
3. **Comunicação clara** - Explicar novos termos de cobrança claramente
4. **Mudanças graduais** - Considerar aumentos de preço em fases
5. **Monitorar métricas** - Rastrear churn após mudanças de cobrança

## Cenários de Erro

- **Assinatura não encontrada**: UUID de assinatura inválido
- **Status inválido**: Assinatura não pode ser atualizada no status atual
- **Frequência inválida**: Frequência de cobrança não suportada
- **Valor inválido**: Valores negativos ou zero não permitidos
- **Permissão negada**: Chave de API não tem acesso à assinatura

## Casos de Uso

<CardGroup cols={2}>
  <Card title="Upgrades de Plano" icon="arrow-up">
    Cliente faz upgrade para tier superior
  </Card>
  <Card title="Downgrades de Plano" icon="arrow-down">
    Cliente faz downgrade para tier inferior
  </Card>
  <Card title="Frequência de Cobrança" icon="calendar">
    Cliente muda de mensal para anual
  </Card>
  <Card title="Ajustes de Preço" icon="dollar-sign">
    Atualizações de preços baseadas no mercado
  </Card>
</CardGroup>

## Testando Atualizações

Use nosso ambiente sandbox para testar atualizações de assinatura:

1. Criar uma assinatura de teste
2. Atualizar com valores diferentes
3. Verificar a `changeEffectiveDate`
4. Verificar notificações de webhook
5. Validar comportamento de cobrança